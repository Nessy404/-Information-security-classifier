<doc>
  <source auto="true" type="str" verify="true"><![CDATA[https://habr.com/ru/company/trendmicro/blog/445538/]]></source>
  <category auto="true" type="str" verify="true"><![CDATA[Информационная безопасность]]></category>
  <author auto="true" type="str" verify="true"><![CDATA[Trend_Micro]]></author>
  <title auto="true" type="str" verify="true"><![CDATA[«Умный» дом с точки зрения уязвимости: разбираемся с векторами и механиками атак]]></title>
  <keywords auto="true" type="list" verify="true">
    <item type="str"><![CDATA[Блог компании Trend Micro]]></item>
    <item type="str"><![CDATA[Информационная безопасность]]></item>
    <item type="str"><![CDATA[Умный дом]]></item>
    <item type="str"><![CDATA[Интернет вещей]]></item>
  </keywords>
  <text auto="true" type="str" verify="true"><![CDATA[ Пока визионеры разного масштаба, авторы сценариев антиутопических фильмов и хайтек-сериалов и прочие выдумщики и алармисты рисуют разной степени убедительности картины о восстании «умных» устройств или применении смарт-дома как орудия убийства или терроризма, специалисты по кибербезопасности и хакеры выходят на новую линию соприкосновения. И речь идёт о реальных и уже (относительно) массово применяемых устройствах, реальных уязвимостях в них и реальных, испытанных способах использовать эти уязвимости в недобрых целях. Вот зачем и как. Пару лет назад в Мичиганском университете провели исследование модельного «умного» дома, ходе которого было установлено и подключено к интернету 18 разных устройств: кровать, светильники, замки, телевизор, кофеварка, зубная щётка и прочее. Одной из главных целей исследования было выявление основных уязвимостей интеллектуальных систем управления домом. В частности, тестировали продукцию компании с говорящим названием SmartThings. После проведения множества разнородных атак на устройства этого «умного» дома, специалисты зафиксировали два основных типа уязвимости: избыточные разрешения и небезопасные сообщения. По части избыточных разрешений или прав выяснились довольно странные и недопустимые вещи: около половины установленных приложений обладают доступом к гораздо большему количеству данных и возможностей, чем это необходимо. Кроме того, при взаимодействии с физическими устройствами приложения обменивались сообщениями , в которых содержались конфиденциальные сведения. Так, приложение для контроля уровня заряда автоматического замка получало ещё и PIN-код для его разблокировки. Программное обеспечение некоторых «умных» устройств генерировало сообщения, похожие на реальные сигналы от физических устройств. Такой подход давал злоумышленникам возможность передавать в сеть недостоверную информацию. В результате пользователь, например, мог быть уверен, что дверь заблокирована, а она на самом деле открыта.Такой подход давал злоумышленникам возможность передавать в сеть недостоверную информацию. В результате пользователь, например, мог быть уверен, что дверь заблокирована, а она на самом деле открыта. Помимо избыточных разрешений и небезопасных сообщений, вскрылась ещё одна существенная проблема — передача конфиденциальной информации на серверы компаний, занимающихся технической поддержкой этих устройств. То есть гаджеты «следили» за своими хозяевами, ежеминутно отправляя информацию об их взаимодействиях с устройствами на сервер. Благодаря этой информации можно восстановить точный распорядок дня жильцов — когда они проснулись, почистили зубы, сколько и какие телевизионные каналы смотрели. За два месяца исследований того «умного» дома в цифровом эфире не было ни одной минуты тишины. Кстати, больше всего «фонила» передачей данных акустическая колонка Amazon Echo, что довольно символично. Не обошлось и без классики в сфере информационной безопасности — бэкдоров. Часто разработчики оставляют для себя «чёрный ход», который позволяет получить полный доступ или контроль над устройством. Производители оправдываются необходимостью предоставлять техническую поддержку пользователям, однако такие создание таких намеренно созданных уязвимостей противоречат практикам защиты информации и являются самой настоящей уязвимостью. То, что практически все производители ПО этим грешат, подтверждается следующим фактом – на конференции Hope X эксперт по ИТ безопасности Джонатан Здзярски (Jonathan Zdziarski) сообщил о присутствии бэкдора в операционной системе iOS, существование которого признала и сама Apple, но назвала его «диагностическим инструментом». Очевидно, что многие, если не все, производители и компонентов «умного» дома оставляют для себя «чёрный ход». Следовательно, это потенциальная дыра в безопасности всего «умного» дома, к любым устройствам которого злоумышленник имеет потенциальную возможность подключиться. Как видим, уязвимостей на аппаратном уровне или на уровне программного обеспечения хватает. Теперь давайте рассмотрим, как страдают от рук хакеров его отдельные его компоненты. Атаки на «умные» замки Тот факт, что закрытую дверь можно открыть не только ключом, а, например, с помощью кода или Bluetooth-сигнала с телефона, уже не вызывает у нас удивления, и многие уже пользуются такой возможностью. Но так ли безопасны и способны противостоять вскрытию «умные» замки, как обещают их производители? Что произойдёт, когда за испытание их непроходимости возьмутся хакеры-профессионалы? А вот что : несколько лет назад на хакерской конференции DEF CON 24 исследователи Энтони Роуз (Anthony Rose) и Бен Рэмси (Ben Ramsey) из Merculite Security рассказали, как в рамках эксперимента проводили атаки на шестнадцать моделей смарт-замков. Результат оказался довольно неутешительным: только четыре смогли устоять перед взломом. Замки одних вендоров передавали пароли доступа открыто, в незашифрованном виде. Так что злоумышленники могли легко их перехватить, используя Bluetooth-сниффер. Несколько замков попались на методе повторного воспроизведения: дверью можно было манипулировать при помощи заранее записанных сигналов соответствующих команд. В свете распространения всевозможных голосовых помощников всё более актуальным становится и взлом умного замка через голосовые команды. Несколько лет назад выяснилось , к примеру, что если хозяйский гаджет лежит достаточно близко к закрытой двери, то достаточно громко произнеся через дверь «Привет, Сири, открой дверь», и вас могут впустить. Распространённым сценарием взлома большинства «умных» замков является следующий: при получении посторонним лицом физического доступа к замку нажатием кнопок на нём можно произвести авторизацию любых гаджетов. Другой интересный эксперимент исследователей из Pen Test Partners был посвящён проверке защищённости замков марки Tapplock. Как выяснилось, их можно разблокировать и без отпечатка пальца владельца. Дело в том, что коды разблокировки генерируются на основании MAC-адреса устройства в сети BLE. А поскольку адрес преобразуется с использованием устаревшего алгоритма MD5, то он легко может быть выяснен. Поскольку Bluetooth-замки имеют свойство разглашать свои MAC-адреса по BLE, то злоумышленник способен узнать адрес, «хакнуть» его с использованием уязвимости MD5 и получить хеш для разблокировки замка. Замок Tapplock, открывающийся с помощью отпечатка пальца Источник: Tapplock Но на этом уязвимости Tapplock не заканчиваются. Выяснилось, что API-сервер компании разглашает конфиденциальные данные пользователей . Любой посторонний человек может узнать не только о местонахождении замка, но и разблокировать его. Сделать это довольно просто: нужно завести аккаунт на Tapplock, взять ID аккаунта жертвы, пройти аутентификацию и захватить управление устройством. При этом на уровне back-end производитель не использует HTTPS. И даже не потребуется никакого взлома или необходимости брутфорсить, потому что номера ID присваиваются аккаунтам по элементарной нарастающей схеме. И ягодка на торте — API не ограничивает количество обращений, поэтому можно бесконечно скачивать пользовательские данные с серверов. И эта проблема всё ещё не устранена. Атаки на видеокамеры Общественные пространства современных мегаполисов обвешаны камерами, как новогодняя ёлка игрушками в приличной семье. Причём всевидящее око не просто получает живую картинку, но и разбирается в том, что на ней. Даже у нас в стране на ЧМ-2018 система распознавания лиц безошибочно отлавливала фанатов , которым был запрещён доступ на стадион. Пока таким образом наша жизнь лишается какой-либо приватности, остаётся дожидаться, когда злоумышленники подберут ключи к «глазам» видеонаблюдения. И банальный вуайеризм будет не единственной и не главной мотивация хакеров для взлома видеокамер. Часто их ломают с целью создания ботнетов, используемых при проведении DDoS-атак. По размерам такие сети часто не уступают, а то и превосходят ботнеты из «обычных» компьютеров. Причин уязвимости у видеокамер несколько: слишком простой или морально устаревший механизм защиты; стандартные пароли, часто находящиеся в открытом доступе в интернете; при подключении к камерам через «облако» клиентские приложения шлют данные в незашифрованном виде; неизменяемый мастер-пароль от производителя. Часто камеры атакуют методом man-in-the-middle, встраиваясь между клиентом и сервером. Таким способом можно не только читать и изменять сообщения, но и подменять видеопоток. Особенно в тех системах, где не поддерживается протокол HTTPS. Так, например, линейка камер одного очень известного производителя имела прошивку, которая позволяет изменять настройки камеры с помощью обычных http-запросов без авторизации . У другого вендора прошивка IP-камер позволяла, также без авторизации, подключиться к камере и получать изображение в реальном времени. Не стоит забывать и про широко известные уязвимости. Например CNVD-2017-02776, проникнув через которую в камеру, далее посредством EternalBlue можно получить доступ к компьютеру пользователя. Эксплоит EternalBlue, использующий уязвимости в протоколе SMB, знаком многим: именно он использовался для распространения шифровальщика WannaCry в 2017 году и в ходе атак зловреда Petya. А ещё EternalBlue был включен в состав Metasploit, его использовали разработчики криптовалютного майнера Adylkuzz, червя EternalRocks, шифровальщика Uiwix, трояна Nitol (он же Backdoor.Nitol), зловреда Gh0st RAT и т.п. Атаки на розетки и лампочки Бывает, что беда приходит оттуда, откуда её не ждёшь. Казалось бы, мелочь, лампочки и розетки, какая может быть выгода для злоумышленников? В качестве шутки отключить системный блок пока вы не нажали кнопку Save в любимой компьютерной игре? Или выключить свет в комнате, где находитесь вы вместе с «умным» ватерклозетом? Однако одно то, что лампочки и розетки находятся в одной локальной сети с другими устройствами, даёт хакерам шанс поживиться довольно секретной информацией. Допустим, ваш дом освещают «умные» лампочки Philips Hue. Это достаточно распространённая модель. Однако в мосте Hue Bridge, через который лампочки общаются друг с другом, существовала брешь. И были случаи, когда через эту уязвимость злоумышленники могли дистанционно перехватить контроль над работой ламп. Напомним, что Philips Hue имеют доступ в домашнюю сеть, где «гуляют» пакеты с различной конфиденциальной информацией. Но как её выудить наружу, если остальные компоненты нашей сети надёжно защищены? ZigBee-контролируемые светодиодные лампы Philips Hue Источник Sho Hashimoto / Wikimedia Хакеры сделали это так. Они заставили лампочку мерцать с частотой свыше 60 Гц. Человек этого не замечает, а вот прибор снаружи здания способен распознать последовательности мерцаний. Конечно, таким способом много не «намерцаешь», но для передачи каких-нибудь паролей или айдишников вполне достаточно. В итоге, секретная информация была скопирована. Помимо этого, в Philips не позаботились об усилении защиты при общении лампочек друг с другом в локальной сети, ограничившись только применением шифрованного беспроводного протокола. Из-за этого злоумышленники могли запустить в локальную сеть поддельное обновление софта, которое «разольётся» потом по всем лампам. Таким образом червь получит возможность подключать лампы к DDoS-атакам. Атакам подвержены и «умные» розетки. Например, в модели SP-1101W компании Edimax для защиты страницы с настройками применялся только логин и пароль, причём производитель никак не предлагал поменять данные по умолчанию. Это наводит на подозрения, что одни и те же пароли использовались на подавляющем большинстве устройств этой компании (или используются по сей день). Добавьте к этому ещё и отсутствие шифрования при обмене данными между сервером производителя и клиентским приложением. Это может привести к тому, что злоумышленник сможет прочитать любые сообщения или даже перехватить управление устройством для, например, подключения к DDoS-атакам. Атаки на смарт-ТВ Ещё одна угроза сохранности наших персональных данных кроется в «умных» телевизорах. Они теперь стоят почти в каждом доме. Причём софт телевизора куда сложнее, чем у камер или замков. Следовательно, хакерам есть где разгуляться. Допустим, на смарт-ТВ есть веб-камера, микрофон, а также веб-браузер, куда же без него? Как в таком случае могут навредить злоумышленники? Они могут воспользоваться банальным фишингом: встроенные в ТВ браузеры обычно слабо защищены, и можно подсунуть пользователю поддельные страницы, собирая пароли, информацию о банковских картах и прочие конфиденциальные данные. Другой, в буквальном смысле, дыркой в безопасности является старый добрый USB. Качнули видео или приложение на компе, воткнули потом флешку в телевизор – вот вам и зараза. Кому может понадобиться знать, какие передачи пользователь смотрит и какие сайты посещает? Много кому, на самом деле. Аналитикам крупных корпораций, консалтинговых и рекламных компаний, например. И эта информация стоит приличных денег, поэтому даже производители не брезгуют встраивать в свою продукцию приложения для сбора вашей статистики. Угроза тут заключается в том, что данные пользователя могут уйти «налево» и попасть к злоумышленникам. Например, квартирный вор узнает, что с 9 утра до 18 вечера дома никого нет, так как у владельцев телевизора есть устойчивая привычка включать его, находясь дома. Соответственно, нужно отключить в настройках сбор лишней информации и прочее журналирование действий. А такие закладки, как вы понимаете, это дополнительные бреши для проникновения. Известна история с телевизорами Samsung: пользователи жаловались на то, что встроенная система распознавания голоса позволяет следить за всеми их разговорами . Производитель даже указал в пользовательском соглашении, что слова, сказанные в присутствии телевизора, могут быть переданы третьей стороне. Выводы и рекомендации по защите Как можно видеть, при создании системы «умного» дома стоит быть предельно внимательным к компонентам и их уязвимостям. Все устройства, подключенные к системе, так или иначе подвержены риску взлома. Инсталляторам и администраторам, а также продвинутым пользователям таких систем можно посоветовать следующее: внимательно изучите все возможности устройства: что оно делает, какие разрешения имеет, какую информацию получает и отправляет — отключите всё ненужное; регулярно обновляйте прошивку и встроенное ПО; используйте сложные пароли; везде, где можно, включайте двухфакторную аутентификацию; для управления «умными» гаджетами и системами используйте только те решения, что предлагают сами вендоры — это не гарантирует отсутствия брешей, но хотя бы снижает вероятность их появления; закрывайте все неиспользуемые сетевые порты, а открытые защищайте стандартными методами авторизации через стандартные настройки операционной системы; вход через пользовательский интерфейс, в том числе с веб-доступом, должен быть защищён с помощью SSL; «умное» устройство должно быть защищено от физического доступа посторонних. Пользователям менее опытным рекомендации такие: не доверяйте чужим людям устройства, с помощью которых вы управляете «умным домом» — если потеряли смартфон или планшет, смените все логины-пароли-ID и прочие вещи, которые могут быть извлечены посредством утерянного гаджета; фишинг не дремлет: как и в случае с электронной почтой и мессенджерами, поменьше доверяйте сообщениям от незнакомцев и непонятным ссылкам. ]]></text>
</doc>
